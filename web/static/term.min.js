(function(){var z=this,e=this.document;function h(){this._events=this._events||{}}h.prototype.addListener=function(B,A){this._events[B]=this._events[B]||[];this._events[B].push(A)};h.prototype.on=h.prototype.addListener;h.prototype.removeListener=function(D,B){if(!this._events[D]){return}var C=this._events[D],A=C.length;while(A--){if(C[A]===B||C[A].listener===B){C.splice(A,1);return}}};h.prototype.off=h.prototype.removeListener;h.prototype.removeAllListeners=function(A){if(this._events[A]){delete this._events[A]}};h.prototype.once=function(C,A){function B(){var D=Array.prototype.slice.call(arguments);this.removeListener(C,B);return A.apply(this,D)}B.listener=A;return this.on(C,B)};h.prototype.emit=function(E){if(!this._events[E]){return}var A=Array.prototype.slice.call(arguments,1),D=this._events[E],C=D.length,B=0;for(;B<C;B++){D[B].apply(this,A)}};h.prototype.listeners=function(A){return this._events[A]=this._events[A]||[]};function v(){h.call(this)}k(v,h);v.prototype.pipe=function(A,E){var F=this,B,D,C;function G(){F.removeListener("data",B);F.removeListener("error",D);F.removeListener("end",C);A.removeListener("error",D);A.removeListener("close",G)}F.on("data",B=function(H){A.write(H)});F.on("error",D=function(H){G();if(!this.listeners("error").length){throw H}});F.on("end",C=function(){A.end();G()});A.on("error",D);A.on("close",G);A.emit("pipe",F);return A};var p=0,g=1,c=2,s=3,b=4,d=5,i=6,y={type:"udk"};function x(B){var C=this;if(!(this instanceof x)){return new x(arguments[0],arguments[1],arguments[2])}v.call(this);if(typeof B==="number"){B={cols:arguments[0],rows:arguments[1],handler:arguments[2]}}B=B||{};f(n(x.defaults),function(D){if(B[D]==null){B[D]=x.options[D];if(x[D]!==x.defaults[D]){B[D]=x[D]}}C[D]=B[D]});if(B.colors.length===8){B.colors=B.colors.concat(x._colors.slice(8))}else{if(B.colors.length===16){B.colors=B.colors.concat(x._colors.slice(16))}else{if(B.colors.length===10){B.colors=B.colors.slice(0,-2).concat(x._colors.slice(8,-2),B.colors.slice(-2))}else{if(B.colors.length===18){B.colors=B.colors.slice(0,-2).concat(x._colors.slice(16,-2),B.colors.slice(-2))}}}}this.colors=B.colors;this.options=B;this.parent=B.body||B.parent||(e?e.getElementsByTagName("body")[0]:null);this.cols=B.cols||B.geometry[0];this.rows=B.rows||B.geometry[1];this.setRawMode;this.isTTY=true;this.isRaw=true;this.columns=this.cols;this.rows=this.rows;if(B.handler){this.on("data",B.handler)}this.ybase=0;this.ydisp=0;this.x=0;this.y=0;this.cursorState=0;this.cursorHidden=false;this.convertEol;this.state=0;this.queue="";this.scrollTop=0;this.scrollBottom=this.rows-1;this.applicationKeypad=false;this.applicationCursor=false;this.originMode=false;this.insertMode=false;this.wraparoundMode=false;this.normal=null;this.prefixMode=false;this.selectMode=false;this.visualMode=false;this.searchMode=false;this.searchDown;this.entry="";this.entryPrefix="Search: ";this._real;this._selected;this._textarea;this.charset=null;this.gcharset=null;this.glevel=0;this.charsets=[null];this.decLocator;this.x10Mouse;this.vt200Mouse;this.vt300Mouse;this.normalMouse;this.mouseEvents;this.sendFocus;this.utfMouse;this.sgrMouse;this.urxvtMouse;this.element;this.children;this.refreshStart;this.refreshEnd;this.savedX;this.savedY;this.savedCols;this.readable=true;this.writable=true;this.defAttr=(0<<18)|(257<<9)|(256<<0);this.curAttr=this.defAttr;this.params=[];this.currentParam=0;this.prefix="";this.postfix="";this.lines=[];var A=this.rows;while(A--){this.lines.push(this.blankLine())}this.tabs;this.setupStops()}k(x,v);x.tangoColors=["#2e3436","#cc0000","#4e9a06","#c4a000","#3465a4","#75507b","#06989a","#d3d7cf","#555753","#ef2929","#8ae234","#fce94f","#729fcf","#ad7fa8","#34e2e2","#eeeeec"];x.xtermColors=["#000000","#cd0000","#00cd00","#cdcd00","#0000ee","#cd00cd","#00cdcd","#e5e5e5","#7f7f7f","#ff0000","#00ff00","#ffff00","#5c5cff","#ff00ff","#00ffff","#ffffff"];x.colors=(function(){var A=x.tangoColors.slice(),E=[0,95,135,175,215,255],C;C=0;for(;C<216;C++){D(E[(C/36)%6|0],E[(C/6)%6|0],E[C%6])}C=0;for(;C<24;C++){E=8+C*10;D(E,E,E)}function D(H,G,F){A.push("#"+B(H)+B(G)+B(F))}function B(F){F=F.toString(16);return F.length<2?"0"+F:F}return A})();x.colors[256]="#000000";x.colors[257]="#f0f0f0";x._colors=x.colors.slice();x.vcolors=(function(){var D=[],B=x.colors,C=0,A;for(;C<256;C++){A=parseInt(B[C].substring(1),16);D.push([(A>>16)&255,(A>>8)&255,A&255])}return D})();x.defaults={colors:x.colors,convertEol:false,termName:"xterm",geometry:[80,24],cursorBlink:true,visualBell:false,popOnBell:false,scrollback:1000,screenKeys:false,debug:false,useStyle:false};x.options={};f(n(x.defaults),function(A){x[A]=x.defaults[A];x.options[A]=x.defaults[A]});x.focus=null;x.prototype.focus=function(){if(x.focus===this){return}if(x.focus){x.focus.blur()}if(this.sendFocus){this.send("\x1b[I")}this.showCursor();x.focus=this};x.prototype.blur=function(){if(x.focus!==this){return}this.cursorState=0;this.refresh(this.y,this.y);if(this.sendFocus){this.send("\x1b[O")}x.focus=null};x.prototype.initGlobal=function(){var A=this.document;x._boundDocs=x._boundDocs||[];if(~j(x._boundDocs,A)){return}x._boundDocs.push(A);x.bindPaste(A);x.bindKeys(A);x.bindCopy(A);if(this.isMobile){this.fixMobile(A)}if(this.useStyle){x.insertStyle(A,this.colors[256],this.colors[257])}};x.bindPaste=function(A){var B=A.defaultView;r(B,"paste",function(C){var D=x.focus;if(!D){return}if(C.clipboardData){D.send(C.clipboardData.getData("text/plain"))}else{if(D.context.clipboardData){D.send(D.context.clipboardData.getData("Text"))}}D.element.contentEditable="inherit";return a(C)})};x.bindKeys=function(A){r(A,"keydown",function(B){if(!x.focus){return}var C=B.target||B.srcElement;if(!C){return}if(C===x.focus.element||C===x.focus.context||C===x.focus.document||C===x.focus.body||C===x._textarea||C===x.focus.parent){return x.focus.keyDown(B)}},true);r(A,"keypress",function(B){if(!x.focus){return}var C=B.target||B.srcElement;if(!C){return}if(C===x.focus.element||C===x.focus.context||C===x.focus.document||C===x.focus.body||C===x._textarea||C===x.focus.parent){return x.focus.keyPress(B)}},true);r(A,"mousedown",function(C){if(!x.focus){return}var B=C.target||C.srcElement;if(!B){return}do{if(B===x.focus.element){return}}while(B=B.parentNode);x.focus.blur()})};x.bindCopy=function(A){var B=A.defaultView;r(B,"copy",function(C){var D=x.focus;if(!D){return}if(!D._selected){return}var F=D.getCopyTextarea();var E=D.grabText(D._selected.x1,D._selected.x2,D._selected.y1,D._selected.y2);D.emit("copy",E);F.focus();F.textContent=E;F.value=E;F.setSelectionRange(0,E.length);u(function(){D.element.focus();D.focus()},1)})};x.prototype.fixMobile=function(A){var B=this;var C=A.createElement("textarea");C.style.position="absolute";C.style.left="-32000px";C.style.top="-32000px";C.style.width="0px";C.style.height="0px";C.style.opacity="0";C.style.backgroundColor="transparent";C.style.borderStyle="none";C.style.outlineStyle="none";C.autocapitalize="none";C.autocorrect="off";A.getElementsByTagName("body")[0].appendChild(C);x._textarea=C;u(function(){C.focus()},1000);if(this.isAndroid){r(C,"change",function(){var D=C.textContent||C.value;C.value="";C.textContent="";B.send(D+"\r")})}};x.insertStyle=function(B,A,C){var E=B.getElementById("term-style");if(E){return}var D=B.getElementsByTagName("head")[0];if(!D){return}var E=B.createElement("style");E.id="term-style";E.innerHTML=".terminal {\n  float: left;\n  border: "+A+' solid 5px;\n  font-family: "DejaVu Sans Mono", "Liberation Mono", monospace;\n  font-size: 11px;\n  color: '+C+";\n  background: "+A+";\n}\n\n.terminal-cursor {\n  color: "+A+";\n  background: "+C+";\n}\n";D.insertBefore(E,D.firstChild)};x.prototype.open=function(C){var D=this,B=0,A;this.parent=C||this.parent;if(!this.parent){throw new Error("Terminal requires a parent element.")}this.context=this.parent.ownerDocument.defaultView;this.document=this.parent.ownerDocument;this.body=this.document.getElementsByTagName("body")[0];if(this.context.navigator&&this.context.navigator.userAgent){this.isMac=!!~this.context.navigator.userAgent.indexOf("Mac");this.isIpad=!!~this.context.navigator.userAgent.indexOf("iPad");this.isIphone=!!~this.context.navigator.userAgent.indexOf("iPhone");this.isAndroid=!!~this.context.navigator.userAgent.indexOf("Android");this.isMobile=this.isIpad||this.isIphone||this.isAndroid;this.isMSIE=!!~this.context.navigator.userAgent.indexOf("MSIE")}this.element=this.document.createElement("div");this.element.className="terminal";this.element.style.outline="none";this.element.setAttribute("tabindex",0);this.element.setAttribute("spellcheck","false");this.element.style.backgroundColor=this.colors[256];this.element.style.color=this.colors[257];this.children=[];for(;B<this.rows;B++){A=this.document.createElement("div");this.element.appendChild(A);this.children.push(A)}this.parent.appendChild(this.element);this.refresh(0,this.rows-1);if(!("useEvents" in this.options)||this.options.useEvents){this.initGlobal()}if(!("useFocus" in this.options)||this.options.useFocus){this.focus();this.startBlink();r(this.element,"focus",function(){D.focus();if(D.isMobile){x._textarea.focus()}});r(this.element,"mousedown",function(){D.focus()});r(this.element,"mousedown",function(F){var E=F.button!=null?+F.button:F.which!=null?F.which-1:null;if(D.isMSIE){E=E===1?0:E===4?1:E}if(E!==2){return}D.element.contentEditable="true";u(function(){D.element.contentEditable="inherit"},1)},true)}if(!("useMouse" in this.options)||this.options.useMouse){this.bindMouse()}if(!("useFocus" in this.options)||this.options.useFocus){u(function(){D.element.focus()},100)}if(x.brokenBold==null){x.brokenBold=l(this.document)}this.emit("open")};x.prototype.setRawMode=function(A){this.isRaw=!!A};x.prototype.bindMouse=function(){var A=this.element,F=this,E=32;var J="onmousewheel" in this.context?"mousewheel":"DOMMouseScroll";function G(L){var K,M;K=C(L);M=D(L);if(!M){return}H(K,M);switch(L.type){case"mousedown":E=K;break;case"mouseup":E=32;break;case J:break}}function I(L){var K=E,M;M=D(L);if(!M){return}K+=32;H(K,M)}function B(L,K){if(!F.utfMouse){if(K===255){return L.push(0)}if(K>127){K=127}L.push(K)}else{if(K===2047){return L.push(0)}if(K<127){L.push(K)}else{if(K>2047){K=2047}L.push(192|(K>>6));L.push(128|(K&63))}}}function H(K,M){if(F.vt300Mouse){K&=3;M.x-=32;M.y-=32;var L="\x1b[24";if(K===0){L+="1"}else{if(K===1){L+="3"}else{if(K===2){L+="5"}else{if(K===3){return}else{L+="0"}}}}L+="~["+M.x+","+M.y+"]\r";F.send(L);return}if(F.decLocator){K&=3;M.x-=32;M.y-=32;if(K===0){K=2}else{if(K===1){K=4}else{if(K===2){K=6}else{if(K===3){K=3}}}}F.send("\x1b["+K+";"+(K===3?4:0)+";"+M.y+";"+M.x+";"+(M.page||0)+"&w");return}if(F.urxvtMouse){M.x-=32;M.y-=32;M.x++;M.y++;F.send("\x1b["+K+";"+M.x+";"+M.y+"M");return}if(F.sgrMouse){M.x-=32;M.y-=32;F.send("\x1b[<"+((K&3)===3?K&~3:K)+";"+M.x+";"+M.y+((K&3)===3?"m":"M"));return}var L=[];B(L,K);B(L,M.x);B(L,M.y);F.send("\x1b[M"+w.fromCharCode.apply(w,L))}function C(M){var K,P,N,L,O;switch(M.type){case"mousedown":K=M.button!=null?+M.button:M.which!=null?M.which-1:null;if(F.isMSIE){K=K===1?0:K===4?1:K}break;case"mouseup":K=3;break;case"DOMMouseScroll":K=M.detail<0?64:65;break;case"mousewheel":K=M.wheelDeltaY>0?64:65;break}P=M.shiftKey?4:0;N=M.metaKey?8:0;L=M.ctrlKey?16:0;O=P|N|L;if(F.vt200Mouse){O&=L}else{if(!F.normalMouse){O=0}}K=(32+(O<<2))+K;return K}function D(L){var O,P,N,M,K;if(L.pageX==null){return}O=L.pageX;P=L.pageY;K=F.element;while(K&&K!==F.document.documentElement){O-=K.offsetLeft;P-=K.offsetTop;K="offsetParent" in K?K.offsetParent:K.parentNode}N=F.element.clientWidth;M=F.element.clientHeight;O=Math.round((O/N)*F.cols);P=Math.round((P/M)*F.rows);if(O<0){O=0}if(O>F.cols){O=F.cols}if(P<0){P=0}if(P>F.rows){P=F.rows}O+=32;P+=32;return{x:O,y:P,type:L.type===J?"mousewheel":L.type}}r(A,"mousedown",function(K){if(!F.mouseEvents){return}G(K);F.focus();if(F.normalMouse){r(F.document,"mousemove",I)}if(!F.x10Mouse){r(F.document,"mouseup",function L(M){G(M);if(F.normalMouse){q(F.document,"mousemove",I)}q(F.document,"mouseup",L);return a(M)})}return a(K)});r(A,J,function(K){if(!F.mouseEvents){return}if(F.x10Mouse||F.vt300Mouse||F.decLocator){return}G(K);return a(K)});r(A,J,function(K){if(F.mouseEvents){return}if(F.applicationKeypad){return}if(K.type==="DOMMouseScroll"){F.scrollDisp(K.detail<0?-5:5)}else{F.scrollDisp(K.wheelDeltaY>0?-5:5)}return a(K)})};x.prototype.close=x.prototype.destroySoon=x.prototype.destroy=function(){if(this.destroyed){return}if(this._blink){clearInterval(this._blink);delete this._blink}this.readable=false;this.writable=false;this.destroyed=true;this._events={};this.handler=function(){};this.write=function(){};this.end=function(){};if(this.element.parentNode){this.element.parentNode.removeChild(this.element)}this.emit("end");this.emit("close");this.emit("finish");this.emit("destroy")};x.prototype.refresh=function(M,E){var O,P,H,I,J,C,N,D,A,B,F,G,L,K;if(E-M>=this.rows/2){K=this.element.parentNode;if(K){K.removeChild(this.element)}}N=this.cols;P=M;if(E>=this.lines.length){this.log("`end` is too large. Most likely a bad CSR.");E=this.lines.length-1}for(;P<=E;P++){L=P+this.ydisp;I=this.lines[L];J="";if(P===this.y&&this.cursorState&&(this.ydisp===this.ybase||this.selectMode)&&!this.cursorHidden){O=this.x}else{O=-1}A=this.defAttr;H=0;for(;H<N;H++){D=I[H][0];C=I[H][1];if(H===O){D=-1}if(D!==A){if(A!==this.defAttr){J+="</span>"}if(D!==this.defAttr){if(D===-1){J+='<span class="reverse-video terminal-cursor">'}else{J+='<span style="';B=D&511;F=(D>>9)&511;G=D>>18;if(G&1){if(!x.brokenBold){J+="font-weight:bold;"}if(F<8){F+=8}}if(G&2){J+="text-decoration:underline;"}if(G&4){if(G&2){J=J.slice(0,-1);J+=" blink;"}else{J+="text-decoration:blink;"}}if(G&8){B=(D>>9)&511;F=D&511;if((G&1)&&F<8){F+=8}}if(G&16){J+="visibility:hidden;"}if(B!==256){J+="background-color:"+this.colors[B]+";"}if(F!==257){J+="color:"+this.colors[F]+";"}J+='">'}}}switch(C){case"&":J+="&amp;";break;case"<":J+="&lt;";break;case">":J+="&gt;";break;default:if(C<=" "){J+="&nbsp;"}else{if(m(C)){H++}J+=C}break}A=D}if(A!==this.defAttr){J+="</span>"}this.children[P].innerHTML=J}if(K){K.appendChild(this.element)}};x.prototype._cursorBlink=function(){if(x.focus!==this){return}this.cursorState^=1;this.refresh(this.y,this.y)};x.prototype.showCursor=function(){if(!this.cursorState){this.cursorState=1;this.refresh(this.y,this.y)}else{}};x.prototype.startBlink=function(){if(!this.cursorBlink){return}var A=this;this._blinker=function(){A._cursorBlink()};this._blink=t(this._blinker,500)};x.prototype.refreshBlink=function(){if(!this.cursorBlink||!this._blink){return}clearInterval(this._blink);this._blink=t(this._blinker,500)};x.prototype.scroll=function(){var A;if(++this.ybase===this.scrollback){this.ybase=this.ybase/2|0;this.lines=this.lines.slice(-(this.ybase+this.rows)+1)}this.ydisp=this.ybase;A=this.ybase+this.rows-1;A-=this.rows-1-this.scrollBottom;if(A===this.lines.length){this.lines.push(this.blankLine())}else{this.lines.splice(A,0,this.blankLine())}if(this.scrollTop!==0){if(this.ybase!==0){this.ybase--;this.ydisp=this.ybase}this.lines.splice(this.ybase+this.scrollTop,1)}this.updateRange(this.scrollTop);this.updateRange(this.scrollBottom)};x.prototype.scrollDisp=function(A){this.ydisp+=A;if(this.ydisp>this.ybase){this.ydisp=this.ybase}else{if(this.ydisp<0){this.ydisp=0}}this.refresh(0,this.rows-1)};x.prototype.write=function(C){var F=C.length,D=0,E,B,A;this.refreshStart=this.y;this.refreshEnd=this.y;if(this.ybase!==this.ydisp){this.ydisp=this.ybase;this.maxRange()}for(;D<F;D++,this.lch=A){A=C[D];switch(this.state){case p:switch(A){case"\x07":this.bell();break;case"\n":case"\x0b":case"\x0c":if(this.convertEol){this.x=0}this.y++;if(this.y>this.scrollBottom){this.y--;this.scroll()}break;case"\r":this.x=0;break;case"\x08":if(this.x>0){this.x--}break;case"\t":this.x=this.nextStop();break;case"\x0e":this.setgLevel(1);break;case"\x0f":this.setgLevel(0);break;case"\x1b":this.state=g;break;default:if(A>=" "){if(this.charset&&this.charset[A]){A=this.charset[A]}if(this.x>=this.cols){this.x=0;this.y++;if(this.y>this.scrollBottom){this.y--;this.scroll()}}this.lines[this.y+this.ybase][this.x]=[this.curAttr,A];this.x++;this.updateRange(this.y);if(m(A)){E=this.y+this.ybase;if(this.cols<2||this.x>=this.cols){this.lines[E][this.x-1]=[this.curAttr," "];break}this.lines[E][this.x]=[this.curAttr," "];this.x++}}break}break;case g:switch(A){case"[":this.params=[];this.currentParam=0;this.state=c;break;case"]":this.params=[];this.currentParam=0;this.state=s;break;case"P":this.params=[];this.prefix="";this.currentParam="";this.state=d;break;case"_":this.state=i;break;case"^":this.state=i;break;case"c":this.reset();break;case"E":this.x=0;case"D":this.index();break;case"M":this.reverseIndex();break;case"%":this.setgLevel(0);this.setgCharset(0,x.charsets.US);this.state=p;D++;break;case"(":case")":case"*":case"+":case"-":case".":switch(A){case"(":this.gcharset=0;break;case")":this.gcharset=1;break;case"*":this.gcharset=2;break;case"+":this.gcharset=3;break;case"-":this.gcharset=1;break;case".":this.gcharset=2;break}this.state=b;break;case"/":this.gcharset=3;this.state=b;D--;break;case"N":break;case"O":break;case"n":this.setgLevel(2);break;case"o":this.setgLevel(3);break;case"|":this.setgLevel(3);break;case"}":this.setgLevel(2);break;case"~":this.setgLevel(1);break;case"7":this.saveCursor();this.state=p;break;case"8":this.restoreCursor();this.state=p;break;case"#":this.state=p;D++;break;case"H":this.tabSet();break;case"=":this.log("Serial port requested application keypad.");this.applicationKeypad=true;this.state=p;break;case">":this.log("Switching back to normal keypad.");this.applicationKeypad=false;this.state=p;break;default:this.state=p;this.error("Unknown ESC control: %s.",A);break}break;case b:switch(A){case"0":B=x.charsets.SCLD;break;case"A":B=x.charsets.UK;break;case"B":B=x.charsets.US;break;case"4":B=x.charsets.Dutch;break;case"C":case"5":B=x.charsets.Finnish;break;case"R":B=x.charsets.French;break;case"Q":B=x.charsets.FrenchCanadian;break;case"K":B=x.charsets.German;break;case"Y":B=x.charsets.Italian;break;case"E":case"6":B=x.charsets.NorwegianDanish;break;case"Z":B=x.charsets.Spanish;break;case"H":case"7":B=x.charsets.Swedish;break;case"=":B=x.charsets.Swiss;break;case"/":B=x.charsets.ISOLatin;D++;break;default:B=x.charsets.US;break}this.setgCharset(this.gcharset,B);this.gcharset=null;this.state=p;break;case s:if((this.lch==="\x1b"&&A==="\\")||A==="\x07"){if(this.lch==="\x1b"){if(typeof this.currentParam==="string"){this.currentParam=this.currentParam.slice(0,-1)}else{if(typeof this.currentParam=="number"){this.currentParam=(this.currentParam-("\x1b".charCodeAt(0)-48))/10}}}this.params.push(this.currentParam);switch(this.params[0]){case 0:case 1:case 2:if(this.params[1]){this.title=this.params[1];this.handleTitle(this.title)}break;case 3:break;case 4:case 5:break;case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:break;case 46:break;case 50:break;case 51:break;case 52:break;case 104:case 105:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:break}this.params=[];this.currentParam=0;this.state=p}else{if(!this.params.length){if(A>="0"&&A<="9"){this.currentParam=this.currentParam*10+A.charCodeAt(0)-48}else{if(A===";"){this.params.push(this.currentParam);this.currentParam=""}}}else{this.currentParam+=A}}break;case c:if(A==="?"||A===">"||A==="!"){this.prefix=A;break}if(A>="0"&&A<="9"){this.currentParam=this.currentParam*10+A.charCodeAt(0)-48;break}if(A==="$"||A==='"'||A===" "||A==="'"){this.postfix=A;break}this.params.push(this.currentParam);this.currentParam=0;if(A===";"){break}this.state=p;switch(A){case"A":this.cursorUp(this.params);break;case"B":this.cursorDown(this.params);break;case"C":this.cursorForward(this.params);break;case"D":this.cursorBackward(this.params);break;case"H":this.cursorPos(this.params);break;case"J":this.eraseInDisplay(this.params);break;case"K":this.eraseInLine(this.params);break;case"m":if(!this.prefix){this.charAttributes(this.params)}break;case"n":if(!this.prefix){this.deviceStatus(this.params)}break;case"@":this.insertChars(this.params);break;case"E":this.cursorNextLine(this.params);break;case"F":this.cursorPrecedingLine(this.params);break;case"G":this.cursorCharAbsolute(this.params);break;case"L":this.insertLines(this.params);break;case"M":this.deleteLines(this.params);break;case"P":this.deleteChars(this.params);break;case"X":this.eraseChars(this.params);break;case"`":this.charPosAbsolute(this.params);break;case"a":this.HPositionRelative(this.params);break;case"c":this.sendDeviceAttributes(this.params);break;case"d":this.linePosAbsolute(this.params);break;case"e":this.VPositionRelative(this.params);break;case"f":this.HVPosition(this.params);break;case"h":this.setMode(this.params);break;case"l":this.resetMode(this.params);break;case"r":this.setScrollRegion(this.params);break;case"s":this.saveCursor(this.params);break;case"u":this.restoreCursor(this.params);break;case"I":this.cursorForwardTab(this.params);break;case"S":this.scrollUp(this.params);break;case"T":if(this.params.length<2&&!this.prefix){this.scrollDown(this.params)}break;case"Z":this.cursorBackwardTab(this.params);break;case"b":this.repeatPrecedingCharacter(this.params);break;case"g":this.tabClear(this.params);break;case"p":switch(this.prefix){case"!":this.softReset(this.params);break}break;default:this.error("Unknown CSI code: %s.",A);break}this.prefix="";this.postfix="";break;case d:if((this.lch==="\x1b"&&A==="\\")||A==="\x07"){if(this.prefix==="tmux;\x1b"){if(A==="\x07"){this.currentParam+=A;continue}}if(this.lch==="\x1b"){if(typeof this.currentParam==="string"){this.currentParam=this.currentParam.slice(0,-1)}else{if(typeof this.currentParam=="number"){this.currentParam=(this.currentParam-("\x1b".charCodeAt(0)-48))/10}}}this.params.push(this.currentParam);var G=this.params[this.params.length-1];switch(this.prefix){case y:this.emit("udk",{clearAll:this.params[0]===0,eraseBelow:this.params[0]===1,lockKeys:this.params[1]===0,dontLockKeys:this.params[1]===1,keyList:(this.params[2]+"").split(";").map(function(I){I=I.split("/");return{keyCode:I[0],hexKeyValue:I[1]}})});break;case"$q":var H=0;switch(G){case'"q':G='0"q';H=1;break;case'"p':G='61;0"p';H=1;break;case"r":G=""+(this.scrollTop+1)+";"+(this.scrollBottom+1)+"r";H=1;break;case"m":H=0;break;default:this.error("Unknown DCS Pt: %s.",G);H=0;break}this.send("\x1bP"+H+"$r"+G+"\x1b\\");break;case"+p":this.emit("set terminfo",{name:this.params[0]});break;case"+q":var H=false;this.send("\x1bP"+ +H+"+r"+G+"\x1b\\");break;case"tmux;\x1b":this.emit("passthrough",G);break;default:this.error("Unknown DCS prefix: %s.",G);break}this.currentParam=0;this.prefix="";this.state=p}else{this.currentParam+=A;if(!this.prefix){if(/^\d*;\d*\|/.test(this.currentParam)){this.prefix=y;this.params=this.currentParam.split(/[;|]/).map(function(I){if(!I.length){return 0}return +I}).slice(0,-1);this.currentParam=""}else{if(/^[$+][a-zA-Z]/.test(this.currentParam)||/^\w+;\x1b/.test(this.currentParam)){this.prefix=this.currentParam;this.currentParam=""}}}}break;case i:if((this.lch==="\x1b"&&A==="\\")||A==="\x07"){this.state=p}break}}this.updateRange(this.y);this.refresh(this.refreshStart,this.refreshEnd);return true};x.prototype.writeln=function(A){return this.write(A+"\r\n")};x.prototype.end=function(A){var B=true;if(A){B=this.write(A)}this.destroySoon();return B};x.prototype.resume=function(){};x.prototype.pause=function(){};x.prototype.keyDown=function(A){var C=this,B;switch(A.keyCode){case 8:if(A.altKey){B="\x17";break}if(A.shiftKey){B="\x08";break}B="\x7f";break;case 9:if(A.shiftKey){B="\x1b[Z";break}B="\t";break;case 13:B="\r";break;case 27:B="\x1b";break;case 37:if(this.applicationCursor){B="\x1bOD";break}if(A.ctrlKey){B="\x1b[5D";break}B="\x1b[D";break;case 39:if(this.applicationCursor){B="\x1bOC";break}if(A.ctrlKey){B="\x1b[5C";break}B="\x1b[C";break;case 38:if(this.applicationCursor){B="\x1bOA";break}if(A.ctrlKey){this.scrollDisp(-1);return a(A)}else{B="\x1b[A"}break;case 40:if(this.applicationCursor){B="\x1bOB";break}if(A.ctrlKey){this.scrollDisp(1);return a(A)}else{B="\x1b[B"}break;case 46:B="\x1b[3~";break;case 45:B="\x1b[2~";break;case 36:if(this.applicationKeypad){B="\x1bOH";break}B="\x1bOH";break;case 35:if(this.applicationKeypad){B="\x1bOF";break}B="\x1bOF";break;case 33:if(A.shiftKey){this.scrollDisp(-(this.rows-1));return a(A)}else{B="\x1b[5~"}break;case 34:if(A.shiftKey){this.scrollDisp(this.rows-1);return a(A)}else{B="\x1b[6~"}break;case 112:B="\x1bOP";break;case 113:B="\x1bOQ";break;case 114:B="\x1bOR";break;case 115:B="\x1bOS";break;case 116:B="\x1b[15~";break;case 117:B="\x1b[17~";break;case 118:B="\x1b[18~";break;case 119:B="\x1b[19~";break;case 120:B="\x1b[20~";break;case 121:B="\x1b[21~";break;case 122:B="\x1b[23~";break;case 123:B="\x1b[24~";break;default:if(A.ctrlKey){if(A.keyCode>=65&&A.keyCode<=90){if(this.screenKeys){if(!this.prefixMode&&!this.selectMode&&A.keyCode===65){this.enterPrefix();return a(A)}}if(this.prefixMode&&A.keyCode===86){this.leavePrefix();return}if((this.prefixMode||this.selectMode)&&A.keyCode===67){if(this.visualMode){u(function(){C.leaveVisual()},1)}return}B=w.fromCharCode(A.keyCode-64)}else{if(A.keyCode===32){B=w.fromCharCode(0)}else{if(A.keyCode>=51&&A.keyCode<=55){B=w.fromCharCode(A.keyCode-51+27)}else{if(A.keyCode===56){B=w.fromCharCode(127)}else{if(A.keyCode===219){B=w.fromCharCode(27)}else{if(A.keyCode===221){B=w.fromCharCode(29)}}}}}}}else{if(A.altKey){if(A.keyCode>=65&&A.keyCode<=90){B="\x1b"+w.fromCharCode(A.keyCode+32)}else{if(A.keyCode===192){B="\x1b`"}else{if(A.keyCode>=48&&A.keyCode<=57){B="\x1b"+(A.keyCode-48)}}}}}break}if(!B){return true}if(this.prefixMode){this.leavePrefix();return a(A)}if(this.selectMode){this.keySelect(A,B);return a(A)}this.emit("keydown",A);this.emit("key",B,A);this.showCursor();this.handler(B);return a(A)};x.prototype.setgLevel=function(A){this.glevel=A;this.charset=this.charsets[A]};x.prototype.setgCharset=function(B,A){this.charsets[B]=A;if(this.glevel===B){this.charset=A}};x.prototype.keyPress=function(A){var B;a(A);if(A.charCode){B=A.charCode}else{if(A.which==null){B=A.keyCode}else{if(A.which!==0&&A.charCode!==0){B=A.which}else{return false}}}if(!B||A.ctrlKey||A.altKey||A.metaKey){return false}B=w.fromCharCode(B);if(this.prefixMode){this.leavePrefix();this.keyPrefix(A,B);return false}if(this.selectMode){this.keySelect(A,B);return false}this.emit("keypress",B,A);this.emit("key",B,A);this.showCursor();this.handler(B);return false};x.prototype.send=function(A){var B=this;if(!this.queue){u(function(){B.handler(B.queue);B.queue=""},1)}this.queue+=A};x.prototype.bell=function(){this.emit("bell");if(!this.visualBell){return}var A=this;this.element.style.borderColor="white";u(function(){A.element.style.borderColor=""},10);if(this.popOnBell){this.focus()}};x.prototype.log=function(){if(!this.debug){return}if(!this.context.console||!this.context.console.log){return}var A=Array.prototype.slice.call(arguments);this.context.console.log.apply(this.context.console,A)};x.prototype.error=function(){if(!this.debug){return}if(!this.context.console||!this.context.console.error){return}var A=Array.prototype.slice.call(arguments);this.context.console.error.apply(this.context.console,A)};x.prototype.resize=function(F,G){var E,B,C,D,A;if(F<1){F=1}if(G<1){G=1}D=this.cols;if(D<F){A=[this.defAttr," "];C=this.lines.length;while(C--){while(this.lines[C].length<F){this.lines[C].push(A)}}}else{if(D>F){C=this.lines.length;while(C--){while(this.lines[C].length>F){this.lines[C].pop()}}}}this.setupStops(D);this.cols=F;this.columns=F;D=this.rows;if(D<G){B=this.element;while(D++<G){if(this.lines.length<G+this.ybase){this.lines.push(this.blankLine())}if(this.children.length<G){E=this.document.createElement("div");B.appendChild(E);this.children.push(E)}}}else{if(D>G){while(D-->G){if(this.lines.length>G+this.ybase){this.lines.pop()}if(this.children.length>G){B=this.children.pop();if(!B){continue}B.parentNode.removeChild(B)}}}}this.rows=G;if(this.y>=G){this.y=G-1}if(this.x>=F){this.x=F-1}this.scrollTop=0;this.scrollBottom=G-1;this.refresh(0,this.rows-1);this.normal=null;this.emit("resize")};x.prototype.updateRange=function(A){if(A<this.refreshStart){this.refreshStart=A}if(A>this.refreshEnd){this.refreshEnd=A}};x.prototype.maxRange=function(){this.refreshStart=0;this.refreshEnd=this.rows-1};x.prototype.setupStops=function(A){if(A!=null){if(!this.tabs[A]){A=this.prevStop(A)}}else{this.tabs={};A=0}for(;A<this.cols;A+=8){this.tabs[A]=true}};x.prototype.prevStop=function(A){if(A==null){A=this.x}while(!this.tabs[--A]&&A>0){}return A>=this.cols?this.cols-1:A<0?0:A};x.prototype.nextStop=function(A){if(A==null){A=this.x}while(!this.tabs[++A]&&A<this.cols){}return A>=this.cols?this.cols-1:A<0?0:A};x.prototype.eraseAttr=function(){return(this.defAttr&~511)|(this.curAttr&511)};x.prototype.eraseRight=function(C,D){var B=this.lines[this.ybase+D],A=[this.eraseAttr()," "];for(;C<this.cols;C++){B[C]=A}this.updateRange(D)};x.prototype.eraseLeft=function(C,D){var B=this.lines[this.ybase+D],A=[this.eraseAttr()," "];C++;while(C--){B[C]=A}this.updateRange(D)};x.prototype.eraseLine=function(A){this.eraseRight(0,A)};x.prototype.blankLine=function(C){var A=C?this.eraseAttr():this.defAttr;var B=[A," "],E=[],D=0;for(;D<this.cols;D++){E[D]=B}return E};x.prototype.ch=function(A){return A?[this.eraseAttr()," "]:[this.defAttr," "]};x.prototype.is=function(B){var A=this.termName;return(A+"").indexOf(B)===0};x.prototype.handler=function(A){this.emit("data",A)};x.prototype.handleTitle=function(A){this.emit("title",A)};x.prototype.index=function(){this.y++;if(this.y>this.scrollBottom){this.y--;this.scroll()}this.state=p};x.prototype.reverseIndex=function(){var A;this.y--;if(this.y<this.scrollTop){this.y++;this.lines.splice(this.y+this.ybase,0,this.blankLine(true));A=this.rows-1-this.scrollBottom;this.lines.splice(this.rows-1+this.ybase-A+1,1);this.updateRange(this.scrollTop);this.updateRange(this.scrollBottom)}this.state=p};x.prototype.reset=function(){this.options.rows=this.rows;this.options.cols=this.cols;x.call(this,this.options);this.refresh(0,this.rows-1)};x.prototype.tabSet=function(){this.tabs[this.x]=true;this.state=p};x.prototype.cursorUp=function(B){var A=B[0];if(A<1){A=1}this.y-=A;if(this.y<0){this.y=0}};x.prototype.cursorDown=function(B){var A=B[0];if(A<1){A=1}this.y+=A;if(this.y>=this.rows){this.y=this.rows-1}};x.prototype.cursorForward=function(B){var A=B[0];if(A<1){A=1}this.x+=A;if(this.x>=this.cols){this.x=this.cols-1}};x.prototype.cursorBackward=function(B){var A=B[0];if(A<1){A=1}this.x-=A;if(this.x<0){this.x=0}};x.prototype.cursorPos=function(B){var C,A;C=B[0]-1;if(B.length>=2){A=B[1]-1}else{A=0}if(C<0){C=0}else{if(C>=this.rows){C=this.rows-1}}if(A<0){A=0}else{if(A>=this.cols){A=this.cols-1}}this.x=A;this.y=C};x.prototype.eraseInDisplay=function(B){var A;switch(B[0]){case 0:this.eraseRight(this.x,this.y);A=this.y+1;for(;A<this.rows;A++){this.eraseLine(A)}break;case 1:this.eraseLeft(this.x,this.y);A=this.y;while(A--){this.eraseLine(A)}break;case 2:A=this.rows;while(A--){this.eraseLine(A)}break;case 3:break}};x.prototype.eraseInLine=function(A){switch(A[0]){case 0:this.eraseRight(this.x,this.y);break;case 1:this.eraseLeft(this.x,this.y);break;case 2:this.eraseLine(this.y);break}};x.prototype.charAttributes=function(G){if(G.length===1&&G[0]===0){this.curAttr=this.defAttr;return}var E=G.length,D=0,C=this.curAttr>>18,B=(this.curAttr>>9)&511,A=this.curAttr&511,F;for(;D<E;D++){F=G[D];if(F>=30&&F<=37){B=F-30}else{if(F>=40&&F<=47){A=F-40}else{if(F>=90&&F<=97){F+=8;B=F-90}else{if(F>=100&&F<=107){F+=8;A=F-100}else{if(F===0){C=this.defAttr>>18;B=(this.defAttr>>9)&511;A=this.defAttr&511}else{if(F===1){C|=1}else{if(F===4){C|=2}else{if(F===5){C|=4}else{if(F===7){C|=8}else{if(F===8){C|=16}else{if(F===22){C&=~1}else{if(F===24){C&=~2}else{if(F===25){C&=~4}else{if(F===27){C&=~8}else{if(F===28){C&=~16}else{if(F===39){B=(this.defAttr>>9)&511}else{if(F===49){A=this.defAttr&511}else{if(F===38){if(G[D+1]===2){D+=2;B=o(G[D]&255,G[D+1]&255,G[D+2]&255);if(B===-1){B=511}D+=2}else{if(G[D+1]===5){D+=2;F=G[D]&255;B=F}}}else{if(F===48){if(G[D+1]===2){D+=2;A=o(G[D]&255,G[D+1]&255,G[D+2]&255);if(A===-1){A=511}D+=2}else{if(G[D+1]===5){D+=2;F=G[D]&255;A=F}}}else{if(F===100){B=(this.defAttr>>9)&511;A=this.defAttr&511}else{this.error("Unknown SGR attribute: %d.",F)}}}}}}}}}}}}}}}}}}}}}this.curAttr=(C<<18)|(B<<9)|A};x.prototype.deviceStatus=function(A){if(!this.prefix){switch(A[0]){case 5:this.send("\x1b[0n");break;case 6:this.send("\x1b["+(this.y+1)+";"+(this.x+1)+"R");break}}else{if(this.prefix==="?"){switch(A[0]){case 6:this.send("\x1b[?"+(this.y+1)+";"+(this.x+1)+"R");break;case 15:break;case 25:break;case 26:break;case 53:break}}}};x.prototype.insertChars=function(D){var C,E,B,A;C=D[0];if(C<1){C=1}E=this.y+this.ybase;B=this.x;A=[this.eraseAttr()," "];while(C--&&B<this.cols){this.lines[E].splice(B++,0,A);this.lines[E].pop()}};x.prototype.cursorNextLine=function(B){var A=B[0];if(A<1){A=1}this.y+=A;if(this.y>=this.rows){this.y=this.rows-1}this.x=0};x.prototype.cursorPrecedingLine=function(B){var A=B[0];if(A<1){A=1}this.y-=A;if(this.y<0){this.y=0}this.x=0};x.prototype.cursorCharAbsolute=function(B){var A=B[0];if(A<1){A=1}this.x=A-1};x.prototype.insertLines=function(C){var B,D,A;B=C[0];if(B<1){B=1}D=this.y+this.ybase;A=this.rows-1-this.scrollBottom;A=this.rows-1+this.ybase-A+1;while(B--){this.lines.splice(D,0,this.blankLine(true));this.lines.splice(A,1)}this.updateRange(this.y);this.updateRange(this.scrollBottom)};x.prototype.deleteLines=function(C){var B,D,A;B=C[0];if(B<1){B=1}D=this.y+this.ybase;A=this.rows-1-this.scrollBottom;A=this.rows-1+this.ybase-A;while(B--){this.lines.splice(A+1,0,this.blankLine(true));this.lines.splice(D,1)}this.updateRange(this.y);this.updateRange(this.scrollBottom)};x.prototype.deleteChars=function(C){var B,D,A;B=C[0];if(B<1){B=1}D=this.y+this.ybase;A=[this.eraseAttr()," "];while(B--){this.lines[D].splice(this.x,1);this.lines[D].push(A)}};x.prototype.eraseChars=function(D){var C,E,B,A;C=D[0];if(C<1){C=1}E=this.y+this.ybase;B=this.x;A=[this.eraseAttr()," "];while(C--&&B<this.cols){this.lines[E][B++]=A}};x.prototype.charPosAbsolute=function(B){var A=B[0];if(A<1){A=1}this.x=A-1;if(this.x>=this.cols){this.x=this.cols-1}};x.prototype.HPositionRelative=function(B){var A=B[0];if(A<1){A=1}this.x+=A;if(this.x>=this.cols){this.x=this.cols-1}};x.prototype.sendDeviceAttributes=function(A){if(A[0]>0){return}if(!this.prefix){if(this.is("xterm")||this.is("rxvt-unicode")||this.is("screen")){this.send("\x1b[?1;2c")}else{if(this.is("linux")){this.send("\x1b[?6c")}}}else{if(this.prefix===">"){if(this.is("xterm")){this.send("\x1b[>0;276;0c")}else{if(this.is("rxvt-unicode")){this.send("\x1b[>85;95;0c")}else{if(this.is("linux")){this.send(A[0]+"c")}else{if(this.is("screen")){this.send("\x1b[>83;40003;0c")}}}}}}};x.prototype.linePosAbsolute=function(B){var A=B[0];if(A<1){A=1}this.y=A-1;if(this.y>=this.rows){this.y=this.rows-1}};x.prototype.VPositionRelative=function(B){var A=B[0];if(A<1){A=1}this.y+=A;if(this.y>=this.rows){this.y=this.rows-1}};x.prototype.HVPosition=function(A){if(A[0]<1){A[0]=1}if(A[1]<1){A[1]=1}this.y=A[0]-1;if(this.y>=this.rows){this.y=this.rows-1}this.x=A[1]-1;if(this.x>=this.cols){this.x=this.cols-1}};x.prototype.setMode=function(D){if(typeof D==="object"){var B=D.length,A=0;for(;A<B;A++){this.setMode(D[A])}return}if(!this.prefix){switch(D){case 4:this.insertMode=true;break;case 20:break}}else{if(this.prefix==="?"){switch(D){case 1:this.applicationCursor=true;break;case 2:this.setgCharset(0,x.charsets.US);this.setgCharset(1,x.charsets.US);this.setgCharset(2,x.charsets.US);this.setgCharset(3,x.charsets.US);break;case 3:this.savedCols=this.cols;this.resize(132,this.rows);break;case 6:this.originMode=true;break;case 7:this.wraparoundMode=true;break;case 12:break;case 66:this.log("Serial port requested application keypad.");this.applicationKeypad=true;break;case 9:case 1000:case 1002:case 1003:this.x10Mouse=D===9;this.vt200Mouse=D===1000;this.normalMouse=D>1000;this.mouseEvents=true;this.element.style.cursor="default";this.log("Binding to mouse events.");break;case 1004:this.sendFocus=true;break;case 1005:this.utfMouse=true;break;case 1006:this.sgrMouse=true;break;case 1015:this.urxvtMouse=true;break;case 25:this.cursorHidden=false;break;case 1049:case 47:case 1047:if(!this.normal){var C={lines:this.lines,ybase:this.ybase,ydisp:this.ydisp,x:this.x,y:this.y,scrollTop:this.scrollTop,scrollBottom:this.scrollBottom,tabs:this.tabs};this.reset();this.normal=C;this.showCursor()}break}}}};x.prototype.resetMode=function(C){if(typeof C==="object"){var B=C.length,A=0;for(;A<B;A++){this.resetMode(C[A])}return}if(!this.prefix){switch(C){case 4:this.insertMode=false;break;case 20:break}}else{if(this.prefix==="?"){switch(C){case 1:this.applicationCursor=false;break;case 3:if(this.cols===132&&this.savedCols){this.resize(this.savedCols,this.rows)}delete this.savedCols;break;case 6:this.originMode=false;break;case 7:this.wraparoundMode=false;break;case 12:break;case 66:this.log("Switching back to normal keypad.");this.applicationKeypad=false;break;case 9:case 1000:case 1002:case 1003:this.x10Mouse=false;this.vt200Mouse=false;this.normalMouse=false;this.mouseEvents=false;this.element.style.cursor="";break;case 1004:this.sendFocus=false;break;case 1005:this.utfMouse=false;break;case 1006:this.sgrMouse=false;break;case 1015:this.urxvtMouse=false;break;case 25:this.cursorHidden=true;break;case 1049:case 47:case 1047:if(this.normal){this.lines=this.normal.lines;this.ybase=this.normal.ybase;this.ydisp=this.normal.ydisp;this.x=this.normal.x;this.y=this.normal.y;this.scrollTop=this.normal.scrollTop;this.scrollBottom=this.normal.scrollBottom;this.tabs=this.normal.tabs;this.normal=null;this.refresh(0,this.rows-1);this.showCursor()}break}}}};x.prototype.setScrollRegion=function(A){if(this.prefix){return}this.scrollTop=(A[0]||1)-1;this.scrollBottom=(A[1]||this.rows)-1;this.x=0;this.y=0};x.prototype.saveCursor=function(A){this.savedX=this.x;this.savedY=this.y};x.prototype.restoreCursor=function(A){this.x=this.savedX||0;this.y=this.savedY||0};x.prototype.cursorForwardTab=function(B){var A=B[0]||1;while(A--){this.x=this.nextStop()}};x.prototype.scrollUp=function(B){var A=B[0]||1;while(A--){this.lines.splice(this.ybase+this.scrollTop,1);this.lines.splice(this.ybase+this.scrollBottom,0,this.blankLine())}this.updateRange(this.scrollTop);this.updateRange(this.scrollBottom)};x.prototype.scrollDown=function(B){var A=B[0]||1;while(A--){this.lines.splice(this.ybase+this.scrollBottom,1);this.lines.splice(this.ybase+this.scrollTop,0,this.blankLine())}this.updateRange(this.scrollTop);this.updateRange(this.scrollBottom)};x.prototype.initMouseTracking=function(A){};x.prototype.resetTitleModes=function(A){};x.prototype.cursorBackwardTab=function(B){var A=B[0]||1;while(A--){this.x=this.prevStop()}};x.prototype.repeatPrecedingCharacter=function(D){var C=D[0]||1,B=this.lines[this.ybase+this.y],A=B[this.x-1]||[this.defAttr," "];while(C--){B[this.x++]=A}};x.prototype.tabClear=function(B){var A=B[0];if(A<=0){delete this.tabs[this.x]}else{if(A===3){this.tabs={}}}};x.prototype.mediaCopy=function(A){};x.prototype.setResources=function(A){};x.prototype.disableModifiers=function(A){};x.prototype.setPointerMode=function(A){};x.prototype.softReset=function(A){this.cursorHidden=false;this.insertMode=false;this.originMode=false;this.wraparoundMode=false;this.applicationKeypad=false;this.applicationCursor=false;this.scrollTop=0;this.scrollBottom=this.rows-1;this.curAttr=this.defAttr;this.x=this.y=0;this.charset=null;this.glevel=0;this.charsets=[null]};x.prototype.requestAnsiMode=function(A){};x.prototype.requestPrivateMode=function(A){};x.prototype.setConformanceLevel=function(A){};x.prototype.loadLEDs=function(A){};x.prototype.setCursorStyle=function(A){};x.prototype.setCharProtectionAttr=function(A){};x.prototype.restorePrivateValues=function(A){};x.prototype.setAttrInRectangle=function(F){var H=F[0],D=F[1],B=F[2],G=F[3],A=F[4];var E,C;for(;H<B+1;H++){E=this.lines[this.ybase+H];for(C=D;C<G;C++){E[C]=[A,E[C][1]]}}this.updateRange(F[0]);this.updateRange(F[2])};x.prototype.savePrivateValues=function(A){};x.prototype.manipulateWindow=function(A){};x.prototype.reverseAttrInRectangle=function(A){};x.prototype.setTitleModeFeature=function(A){};x.prototype.setWarningBellVolume=function(A){};x.prototype.setMarginBellVolume=function(A){};x.prototype.copyRectangle=function(A){};x.prototype.enableFilterRectangle=function(A){};x.prototype.requestParameters=function(A){};x.prototype.selectChangeExtent=function(A){};x.prototype.fillRectangle=function(F){var B=F[0],H=F[1],D=F[2],A=F[3],G=F[4];var E,C;for(;H<A+1;H++){E=this.lines[this.ybase+H];for(C=D;C<G;C++){E[C]=[E[C][0],w.fromCharCode(B)]}}this.updateRange(F[1]);this.updateRange(F[3])};x.prototype.enableLocatorReporting=function(A){var B=A[0]>0};x.prototype.eraseRectangle=function(F){var H=F[0],D=F[1],A=F[2],G=F[3];var E,C,B;B=[this.eraseAttr()," "];for(;H<A+1;H++){E=this.lines[this.ybase+H];for(C=D;C<G;C++){E[C]=B}}this.updateRange(F[0]);this.updateRange(F[2])};x.prototype.setLocatorEvents=function(A){};x.prototype.selectiveEraseRectangle=function(A){};x.prototype.requestLocatorPosition=function(A){};x.prototype.insertColumns=function(){var D=params[0],C=this.ybase+this.rows,A=[this.eraseAttr()," "],B;while(D--){for(B=this.ybase;B<C;B++){this.lines[B].splice(this.x+1,0,A);this.lines[B].pop()}}this.maxRange()};x.prototype.deleteColumns=function(){var D=params[0],C=this.ybase+this.rows,A=[this.eraseAttr()," "],B;while(D--){for(B=this.ybase;B<C;B++){this.lines[B].splice(this.x,1);this.lines[B].push(A)}}this.maxRange()};x.prototype.enterPrefix=function(){this.prefixMode=true};x.prototype.leavePrefix=function(){this.prefixMode=false};x.prototype.enterSelect=function(){this._real={x:this.x,y:this.y,ydisp:this.ydisp,ybase:this.ybase,cursorHidden:this.cursorHidden,lines:this.copyBuffer(this.lines),write:this.write};this.write=function(){};this.selectMode=true;this.visualMode=false;this.cursorHidden=false;this.refresh(this.y,this.y)};x.prototype.leaveSelect=function(){this.x=this._real.x;this.y=this._real.y;this.ydisp=this._real.ydisp;this.ybase=this._real.ybase;this.cursorHidden=this._real.cursorHidden;this.lines=this._real.lines;this.write=this._real.write;delete this._real;this.selectMode=false;this.visualMode=false;this.refresh(0,this.rows-1)};x.prototype.enterVisual=function(){this._real.preVisual=this.copyBuffer(this.lines);this.selectText(this.x,this.x,this.ydisp+this.y,this.ydisp+this.y);this.visualMode=true};x.prototype.leaveVisual=function(){this.lines=this._real.preVisual;delete this._real.preVisual;delete this._selected;this.visualMode=false;this.refresh(0,this.rows-1)};x.prototype.enterSearch=function(B){this.entry="";this.searchMode=true;this.searchDown=B;this._real.preSearch=this.copyBuffer(this.lines);this._real.preSearchX=this.x;this._real.preSearchY=this.y;var A=this.ydisp+this.rows-1;for(var C=0;C<this.entryPrefix.length;C++){this.lines[A][C]=[(this.defAttr&~511)|4,this.entryPrefix[C]]}this.y=this.rows-1;this.x=this.entryPrefix.length;this.refresh(this.rows-1,this.rows-1)};x.prototype.leaveSearch=function(){this.searchMode=false;if(this._real.preSearch){this.lines=this._real.preSearch;this.x=this._real.preSearchX;this.y=this._real.preSearchY;delete this._real.preSearch;delete this._real.preSearchX;delete this._real.preSearchY}this.refresh(this.rows-1,this.rows-1)};x.prototype.copyBuffer=function(A){var A=A||this.lines,B=[];for(var D=0;D<A.length;D++){B[D]=[];for(var C=0;C<A[D].length;C++){B[D][C]=[A[D][C][0],A[D][C][1]]}}return B};x.prototype.getCopyTextarea=function(B){var C=this._copyTextarea,A=this.document;if(!C){C=A.createElement("textarea");C.style.position="absolute";C.style.left="-32000px";C.style.top="-32000px";C.style.width="0px";C.style.height="0px";C.style.opacity="0";C.style.backgroundColor="transparent";C.style.borderStyle="none";C.style.outlineStyle="none";A.getElementsByTagName("body")[0].appendChild(C);this._copyTextarea=C}return C};x.prototype.copyText=function(B){var A=this,C=this.getCopyTextarea();this.emit("copy",B);C.focus();C.textContent=B;C.value=B;C.setSelectionRange(0,B.length);u(function(){A.element.focus();A.focus()},1)};x.prototype.selectText=function(H,I,L,M){var B,C,D,E,F,G,K,J,A;if(this._selected){B=this._selected.x1;C=this._selected.x2;D=this._selected.y1;E=this._selected.y2;if(E<D){F=C;C=B;B=F;F=E;E=D;D=F}if(C<B&&D===E){F=C;C=B;B=F}for(K=D;K<=E;K++){G=0;J=this.cols-1;if(K===D){G=B}if(K===E){J=C}for(;G<=J;G++){if(this.lines[K][G].old!=null){A=this.lines[K][G].old;delete this.lines[K][G].old;this.lines[K][G]=[A,this.lines[K][G][1]]}}}L=this._selected.y1;H=this._selected.x1}L=Math.max(L,0);L=Math.min(L,this.ydisp+this.rows-1);M=Math.max(M,0);M=Math.min(M,this.ydisp+this.rows-1);this._selected={x1:H,x2:I,y1:L,y2:M};if(M<L){F=I;I=H;H=F;F=M;M=L;L=F}if(I<H&&L===M){F=I;I=H;H=F}for(K=L;K<=M;K++){G=0;J=this.cols-1;if(K===L){G=H}if(K===M){J=I}for(;G<=J;G++){A=this.lines[K][G][0];this.lines[K][G]=[(A&~511)|((511<<9)|4),this.lines[K][G][1]];this.lines[K][G].old=A}}L=L-this.ydisp;M=M-this.ydisp;L=Math.max(L,0);L=Math.min(L,this.rows-1);M=Math.max(M,0);M=Math.min(M,this.rows-1);this.refresh(0,this.rows-1)};x.prototype.grabText=function(F,G,J,K){var C="",A="",B,E,I,H,D;if(K<J){D=G;G=F;F=D;D=K;K=J;J=D}if(G<F&&J===K){D=G;G=F;F=D}for(I=J;I<=K;I++){E=0;H=this.cols-1;if(I===J){E=F}if(I===K){H=G}for(;E<=H;E++){B=this.lines[I][E][1];if(B===" "){A+=B;continue}if(A){C+=A;A=""}C+=B;if(m(B)){E++}}A="";C+="\n"}for(E=G,I=K;E<this.cols;E++){if(this.lines[I][E][1]!==" "){C=C.slice(0,-1);break}}return C};x.prototype.keyPrefix=function(A,B){if(B==="k"||B==="&"){this.destroy()}else{if(B==="p"||B==="]"){this.emit("request paste")}else{if(B==="c"){this.emit("request create")}else{if(B>="0"&&B<="9"){B=+B-1;if(!~B){B=9}this.emit("request term",B)}else{if(B==="n"){this.emit("request term next")}else{if(B==="P"){this.emit("request term previous")}else{if(B===":"){this.emit("request command mode")}else{if(B==="["){this.enterSelect()}}}}}}}}};x.prototype.keySelect=function(A,E){this.showCursor();if(this.searchMode||E==="n"||E==="N"){return this.keySearch(A,E)}if(E==="\x04"){var N=this.ydisp+this.y;if(this.ydisp===this.ybase){this.y=Math.min(this.y+(this.rows-1)/2|0,this.rows-1);this.refresh(0,this.rows-1)}else{this.scrollDisp((this.rows-1)/2|0)}if(this.visualMode){this.selectText(this.x,this.x,N,this.ydisp+this.y)}return}if(E==="\x15"){var N=this.ydisp+this.y;if(this.ydisp===0){this.y=Math.max(this.y-(this.rows-1)/2|0,0);this.refresh(0,this.rows-1)}else{this.scrollDisp(-(this.rows-1)/2|0)}if(this.visualMode){this.selectText(this.x,this.x,N,this.ydisp+this.y)}return}if(E==="\x06"){var N=this.ydisp+this.y;this.scrollDisp(this.rows-1);if(this.visualMode){this.selectText(this.x,this.x,N,this.ydisp+this.y)}return}if(E==="\x02"){var N=this.ydisp+this.y;this.scrollDisp(-(this.rows-1));if(this.visualMode){this.selectText(this.x,this.x,N,this.ydisp+this.y)}return}if(E==="k"||E==="\x1b[A"){var N=this.ydisp+this.y;this.y--;if(this.y<0){this.y=0;this.scrollDisp(-1)}if(this.visualMode){this.selectText(this.x,this.x,N,this.ydisp+this.y)}else{this.refresh(this.y,this.y+1)}return}if(E==="j"||E==="\x1b[B"){var N=this.ydisp+this.y;this.y++;if(this.y>=this.rows){this.y=this.rows-1;this.scrollDisp(1)}if(this.visualMode){this.selectText(this.x,this.x,N,this.ydisp+this.y)}else{this.refresh(this.y-1,this.y)}return}if(E==="h"||E==="\x1b[D"){var M=this.x;this.x--;if(this.x<0){this.x=0}if(this.visualMode){this.selectText(M,this.x,this.ydisp+this.y,this.ydisp+this.y)}else{this.refresh(this.y,this.y)}return}if(E==="l"||E==="\x1b[C"){var M=this.x;this.x++;if(this.x>=this.cols){this.x=this.cols-1}if(this.visualMode){this.selectText(M,this.x,this.ydisp+this.y,this.ydisp+this.y)}else{this.refresh(this.y,this.y)}return}if(E==="v"||E===" "){if(!this.visualMode){this.enterVisual()}else{this.leaveVisual()}return}if(E==="y"){if(this.visualMode){var L=this.grabText(this._selected.x1,this._selected.x2,this._selected.y1,this._selected.y2);this.copyText(L);this.leaveVisual()}return}if(E==="q"||E==="\x1b"){if(this.visualMode){this.leaveVisual()}else{this.leaveSelect()}return}if(E==="w"||E==="W"){var G=this.x;var H=this.y;var I=this.ydisp;var M=this.x;var N=this.y;var O=this.ydisp;var K=false;for(;;){var F=this.lines[O+N];while(M<this.cols){if(F[M][1]<=" "){K=true}else{if(K){break}}M++}if(M>=this.cols){M=this.cols-1}if(M===this.cols-1&&F[M][1]<=" "){M=0;if(++N>=this.rows){N--;if(++O>this.ybase){O=this.ybase;M=this.x;break}}continue}break}this.x=M,this.y=N;this.scrollDisp(-this.ydisp+O);if(this.visualMode){this.selectText(G,this.x,H+I,this.ydisp+this.y)}return}if(E==="b"||E==="B"){var G=this.x;var H=this.y;var I=this.ydisp;var M=this.x;var N=this.y;var O=this.ydisp;for(;;){var F=this.lines[O+N];var K=M>0&&F[M][1]>" "&&F[M-1][1]>" ";while(M>=0){if(F[M][1]<=" "){if(K&&(M+1<this.cols&&F[M+1][1]>" ")){M++;break}else{K=true}}M--}if(M<0){M=0}if(M===0&&(F[M][1]<=" "||!K)){M=this.cols-1;if(--N<0){N++;if(--O<0){O++;M=0;break}}continue}break}this.x=M,this.y=N;this.scrollDisp(-this.ydisp+O);if(this.visualMode){this.selectText(G,this.x,H+I,this.ydisp+this.y)}return}if(E==="e"||E==="E"){var M=this.x+1;var N=this.y;var O=this.ydisp;if(M>=this.cols){M--}for(;;){var F=this.lines[O+N];while(M<this.cols){if(F[M][1]<=" "){M++}else{break}}while(M<this.cols){if(F[M][1]<=" "){if(M-1>=0&&F[M-1][1]>" "){M--;break}}M++}if(M>=this.cols){M=this.cols-1}if(M===this.cols-1&&F[M][1]<=" "){M=0;if(++N>=this.rows){N--;if(++O>this.ybase){O=this.ybase;break}}continue}break}this.x=M,this.y=N;this.scrollDisp(-this.ydisp+O);if(this.visualMode){this.selectText(G,this.x,H+I,this.ydisp+this.y)}return}if(E==="^"||E==="0"){var G=this.x;if(E==="0"){this.x=0}else{if(E==="^"){var F=this.lines[this.ydisp+this.y];var M=0;while(M<this.cols){if(F[M][1]>" "){break}M++}if(M>=this.cols){M=this.cols-1}this.x=M}}if(this.visualMode){this.selectText(G,this.x,this.ydisp+this.y,this.ydisp+this.y)}else{this.refresh(this.y,this.y)}return}if(E==="$"){var G=this.x;var F=this.lines[this.ydisp+this.y];var M=this.cols-1;while(M>=0){if(F[M][1]>" "){if(this.visualMode&&M<this.cols-1){M++}break}M--}if(M<0){M=0}this.x=M;if(this.visualMode){this.selectText(G,this.x,this.ydisp+this.y,this.ydisp+this.y)}else{this.refresh(this.y,this.y)}return}if(E==="g"||E==="G"){var G=this.x;var H=this.y;var I=this.ydisp;if(E==="g"){this.x=0,this.y=0;this.scrollDisp(-this.ydisp)}else{if(E==="G"){this.x=0,this.y=this.rows-1;this.scrollDisp(this.ybase)}}if(this.visualMode){this.selectText(G,this.x,H+I,this.ydisp+this.y)}return}if(E==="H"||E==="M"||E==="L"){var G=this.x;var H=this.y;if(E==="H"){this.x=0,this.y=0}else{if(E==="M"){this.x=0,this.y=this.rows/2|0}else{if(E==="L"){this.x=0,this.y=this.rows-1}}}if(this.visualMode){this.selectText(G,this.x,this.ydisp+H,this.ydisp+this.y)}else{this.refresh(H,H);this.refresh(this.y,this.y)}return}if(E==="{"||E==="}"){var G=this.x;var H=this.y;var I=this.ydisp;var F;var J=false;var C=false;var B=-1;var N=this.y+(E==="{"?-1:1);var O=this.ydisp;var D;if(E==="{"){if(N<0){N++;if(O>0){O--}}}else{if(E==="}"){if(N>=this.rows){N--;if(O<this.ybase){O++}}}}for(;;){F=this.lines[O+N];for(D=0;D<this.cols;D++){if(F[D][1]>" "){if(B===-1){B=0}J=true;break}else{if(D===this.cols-1){if(B===-1){B=1}else{if(B===0){C=true}else{if(B===1){if(J){C=true}}}}break}}}if(C){break}if(E==="{"){N--;if(N<0){N++;if(O>0){O--}else{break}}}else{if(E==="}"){N++;if(N>=this.rows){N--;if(O<this.ybase){O++}else{break}}}}}if(!C){if(E==="{"){N=0;O=0}else{if(E==="}"){N=this.rows-1;O=this.ybase}}}this.x=0,this.y=N;this.scrollDisp(-this.ydisp+O);if(this.visualMode){this.selectText(G,this.x,H+I,this.ydisp+this.y)}return}if(E==="/"||E==="?"){if(!this.visualMode){this.enterSearch(E==="/")}return}return false};x.prototype.keySearch=function(C,F){if(F==="\x1b"){this.leaveSearch();return}if(F==="\r"||(!this.searchMode&&(F==="n"||F==="N"))){this.leaveSearch();var B=this.entry;if(!B){this.refresh(0,this.rows-1);return}var H=this.x;var I=this.y;var J=this.ydisp;var G;var D=false;var L=false;var M=this.x+1;var N=this.ydisp+this.y;var O,E;var K=F==="N"?this.searchDown:!this.searchDown;for(;;){G=this.lines[N];while(M<this.cols){for(E=0;E<B.length;E++){if(M+E>=this.cols){break}if(G[M+E][1]!==B[E]){break}else{if(G[M+E][1]===B[E]&&E===B.length-1){D=true;break}}}if(D){break}M+=E+1}if(D){break}M=0;if(!K){N++;if(N>this.ybase+this.rows-1){if(L){break}L=true;N=0}}else{N--;if(N<0){if(L){break}L=true;N=this.ybase+this.rows-1}}}if(D){if(N-this.ybase<0){O=N;N=0;if(O>this.ybase){N=O-this.ybase;O=this.ybase}}else{O=this.ybase;N-=this.ybase}this.x=M,this.y=N;this.scrollDisp(-this.ydisp+O);if(this.visualMode){this.selectText(H,this.x,I+J,this.ydisp+this.y)}return}this.refresh(0,this.rows-1);return}if(F==="\b"||F==="\x7f"){if(this.entry.length===0){return}var A=this.ydisp+this.rows-1;this.entry=this.entry.slice(0,-1);var E=this.entryPrefix.length+this.entry.length;this.lines[A][E]=[this.lines[A][E][0]," "];this.x--;this.refresh(this.rows-1,this.rows-1);this.refresh(this.y,this.y);return}if(F.length===1&&F>=" "&&F<="~"){var A=this.ydisp+this.rows-1;this.entry+=F;var E=this.entryPrefix.length+this.entry.length-1;this.lines[A][E]=[(this.defAttr&~511)|4,F];this.x++;this.refresh(this.rows-1,this.rows-1);this.refresh(this.y,this.y);return}return false};x.charsets={};x.charsets.SCLD={"`":"\u25c6",a:"\u2592",b:"\u0009",c:"\u000c",d:"\u000d",e:"\u000a",f:"\u00b0",g:"\u00b1",h:"\u2424",i:"\u000b",j:"\u2518",k:"\u2510",l:"\u250c",m:"\u2514",n:"\u253c",o:"\u23ba",p:"\u23bb",q:"\u2500",r:"\u23bc",s:"\u23bd",t:"\u251c",u:"\u2524",v:"\u2534",w:"\u252c",x:"\u2502",y:"\u2264",z:"\u2265","{":"\u03c0","|":"\u2260","}":"\u00a3","~":"\u00b7"};x.charsets.UK=null;x.charsets.US=null;x.charsets.Dutch=null;x.charsets.Finnish=null;x.charsets.French=null;x.charsets.FrenchCanadian=null;x.charsets.German=null;x.charsets.Italian=null;x.charsets.NorwegianDanish=null;x.charsets.Spanish=null;x.charsets.Swedish=null;x.charsets.Swiss=null;x.charsets.ISOLatin=null;function r(B,D,C,A){B.addEventListener(D,C,A||false)}function q(B,D,C,A){B.removeEventListener(D,C,A||false)}function a(A){if(A.preventDefault){A.preventDefault()}A.returnValue=false;if(A.stopPropagation){A.stopPropagation()}A.cancelBubble=true;return false}function k(A,C){function B(){this.constructor=A}B.prototype=C.prototype;A.prototype=new B}function l(B){var A=B.getElementsByTagName("body")[0];var E=B.createElement("div");E.className="terminal";var D=B.createElement("div");var C=B.createElement("span");C.innerHTML="hello world";D.appendChild(C);E.appendChild(D);A.appendChild(E);var F=C.scrollWidth;C.style.fontWeight="bold";var G=C.scrollWidth;A.removeChild(E);return F!==G}var w=this.String;var u=this.setTimeout;var t=this.setInterval;function j(C,A){var B=C.length;while(B--){if(C[B]===A){return B}}return -1}function m(A){if(A<="\uff00"){return false}return(A>="\uff01"&&A<="\uffbe")||(A>="\uffc2"&&A<="\uffc7")||(A>="\uffca"&&A<="\uffcf")||(A>="\uffd2"&&A<="\uffd7")||(A>="\uffda"&&A<="\uffdc")||(A>="\uffe0"&&A<="\uffe6")||(A>="\uffe8"&&A<="\uffee")}function o(K,E,A){var G=(K<<16)|(E<<8)|A;if(o._cache[G]!=null){return o._cache[G]}var I=Infinity,J=-1,H=0,C,L,F,B,D;for(;H<x.vcolors.length;H++){C=x.vcolors[H];L=C[0];F=C[1];B=C[2];D=o.distance(K,E,A,L,F,B);if(D===0){J=H;break}if(D<I){I=D;J=H}}return o._cache[G]=J}o._cache={};o.distance=function(E,C,A,F,D,B){return Math.pow(30*(E-F),2)+Math.pow(59*(C-D),2)+Math.pow(11*(A-B),2)};function f(D,C,A){if(D.forEach){return D.forEach(C,A)}for(var B=0;B<D.length;B++){C.call(A,D[B],B,D)}}function n(C){if(Object.keys){return Object.keys(C)}var A,B=[];for(A in C){if(Object.prototype.hasOwnProperty.call(C,A)){B.push(A)}}return B}x.EventEmitter=h;x.Stream=v;x.inherits=k;x.on=r;x.off=q;x.cancel=a;if(typeof module!=="undefined"){module.exports=x}else{this.Terminal=x}}).call(function(){return this||(typeof window!=="undefined"?window:global)}());